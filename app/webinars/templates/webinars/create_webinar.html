{% extends "base.html" %}
{% from "_form_macros.html" import render_field, render_checkbox_field %}

{% block title %}Создать новый вебинар{% endblock %}

{% block content %}
<div class="container mt-4">
    <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="{{ url_for('webinars.webinars_list') }}">Вебинары</a></li>
            <li class="breadcrumb-item active" aria-current="page">Создать новый вебинар</li>
        </ol>
    </nav>

    <div class="row justify-content-center">
        <div class="col-lg-9 col-xl-8">
            <div class="card shadow-sm">
                <div class="card-header bg-primary text-white">
                    <h2 class="mb-0 h4"><i class="fas fa-plus-circle me-2"></i>Создать новый вебинар</h2>
                </div>
                <div class="card-body p-4">
                    <form method="POST" action="{{ url_for('webinars.create_webinar') }}" novalidate>
                        {{ form.hidden_tag() }} {# CSRF Token #}

                        <h5 class="mb-3 border-bottom pb-2"><i class="fas fa-info-circle me-2 text-primary"></i>Основная информация</h5>
                        <div class="row g-3 mb-4">
                            <div class="col-md-12">
                                {{ render_field(form.title, class='form-control', label_visible=True) }}
                            </div>
                            <div class="col-md-12">
                                {{ render_field(form.url, class='form-control', label_visible=True) }}
                            </div>
                            <div class="col-md-6">
                                {{ render_field(form.date, class='form-control', type='date', label_visible=True) }}
                            </div>
                            <div class="col-md-6">
                                {{ render_field(form.academic_year, class='form-select', label_visible=True) }}
                            </div>
                            <div class="col-md-12">
                                {{ render_field(form.cover_url, class='form-control', label_visible=True, placeholder='https://example.com/image.jpg') }}
                            </div>
                        </div>

                        <h5 class="mb-3 border-bottom pb-2"><i class="fas fa-cogs me-2 text-primary"></i>Детали вебинара</h5>
                        <div class="row g-3 mb-4">
                            <div class="col-md-6">
                                {{ render_field(form.task_numbers, class='form-control', placeholder='Например: 1, 5, 17', label_visible=True) }}
                            </div>
                             <div class="col-md-6">
                                {{ render_field(form.category, class='form-select', label_visible=True) }}
                            </div>
                        </div>
                        
                        <div class="row g-3 mb-4">
                            <div class="col-md-6">
                                <label class="form-label fw-medium">Тип решения</label>
                                {{ render_checkbox_field(form.is_programming) }}
                                {{ render_checkbox_field(form.is_manual) }}
                                {{ render_checkbox_field(form.is_excel) }}
                            </div>

                            <div class="col-md-6">
                                <label class="form-label fw-medium">Тип курса</label>
                                <div class="form-group mb-4">
                                    <div class="row g-3">
                                        <div class="col-md-4">
                                            <div class="form-check">
                                                {{ form.for_beginners(class="form-check-input") }}
                                                <label class="form-check-label" for="{{ form.for_beginners.id }}">{{ form.for_beginners.label.text }}</label>
                                            </div>
                                        </div>
                                        <div class="col-md-4">
                                            <div class="form-check">
                                                {{ form.for_basic(class="form-check-input") }}
                                                <label class="form-check-label" for="{{ form.for_basic.id }}">{{ form.for_basic.label.text }}</label>
                                            </div>
                                        </div>
                                        <div class="col-md-4">
                                            <div class="form-check">
                                                {{ form.for_advanced(class="form-check-input") }}
                                                <label class="form-check-label" for="{{ form.for_advanced.id }}">{{ form.for_advanced.label.text }}</label>
                                            </div>
                                        </div>
                                        <div class="col-md-4">
                                            <div class="form-check">
                                                {{ form.for_expert(class="form-check-input") }}
                                                <label class="form-check-label" for="{{ form.for_expert.id }}">{{ form.for_expert.label.text }}</label>
                                            </div>
                                        </div>
                                        <div class="col-md-4">
                                            <div class="form-check">
                                                {{ form.for_mocks(class="form-check-input") }}
                                                <label class="form-check-label" for="{{ form.for_mocks.id }}">{{ form.for_mocks.label.text }}</label>
                                            </div>
                                        </div>
                                        <div class="col-md-4">
                                            <div class="form-check">
                                                {{ form.for_practice(class="form-check-input") }}
                                                <label class="form-check-label" for="{{ form.for_practice.id }}">{{ form.for_practice.label.text }}</label>
                                            </div>
                                        </div>
                                        <div class="col-md-4 minisnap-option">
                                            <div class="form-check">
                                                {{ form.for_minisnap(class="form-check-input") }}
                                                <label class="form-check-label" for="{{ form.for_minisnap.id }}">{{ form.for_minisnap.label.text }}</label>
                                            </div>
                                        </div>
                                        <div class="col-md-4 summer-option">
                                            <div class="form-check">
                                                {{ form.for_summer(class="form-check-input") }}
                                                <label class="form-check-label" for="{{ form.for_summer.id }}">{{ form.for_summer.label.text }}</label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <hr class="my-4">

                        <div class="d-flex justify-content-end gap-2">
                            <a href="{{ url_for('webinars.webinars_list') }}" class="btn btn-outline-secondary">Отмена</a>
                            {{ form.submit(class='btn btn-primary px-4') }}
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
{{ super() }}
<script>
    $(document).ready(function() {
        // Обработчик изменения года
        function updateCourseTypeOptions() {
            const selectedYear = parseInt($('#academic_year').val());
            
            if (selectedYear === 2025) {
                $('.minisnap-option').show();
                $('.summer-option').hide();
            } else if (selectedYear === 2026) {
                $('.minisnap-option').hide();
                $('.summer-option').show();
            } else {
                $('.minisnap-option').show();
                $('.summer-option').show();
            }
        }
        
        // Инициализация при загрузке
        updateCourseTypeOptions();
        
        // Обработчик изменения значения поля года
        $('#academic_year').change(updateCourseTypeOptions);
    });
</script>
{% endblock %} 